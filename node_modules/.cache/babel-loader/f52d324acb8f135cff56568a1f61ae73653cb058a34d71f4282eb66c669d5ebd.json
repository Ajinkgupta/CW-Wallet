{"ast":null,"code":"import _regeneratorRuntime from\"/workspace/Cryptway-ETH-Wallet/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/workspace/Cryptway-ETH-Wallet/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/workspace/Cryptway-ETH-Wallet/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import{sendToken}from'../utils/TransactionUtils';import{sepolia}from'../models/Chain';import{ethers}from'ethers';import{toFixedIfNecessary}from'../utils/AccountUtils';import'./Account.css';import{useLocation}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var AccountSend=function AccountSend(_ref){var account=_ref.account;var location=useLocation();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),destinationAddress=_useState2[0],setDestinationAddress=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),amount=_useState4[0],setAmount=_useState4[1];var _useState5=useState(account.balance),_useState6=_slicedToArray(_useState5,2),balance=_useState6[0],setBalance=_useState6[1];var _useState7=useState({status:null,message:''}),_useState8=_slicedToArray(_useState7,2),networkResponse=_useState8[0],setNetworkResponse=_useState8[1];useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var provider,accountBalance;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:provider=new ethers.providers.JsonRpcProvider(sepolia.rpcUrl);_context.next=3;return provider.getBalance(account.address);case 3:accountBalance=_context.sent;setBalance(String(toFixedIfNecessary(ethers.utils.formatEther(accountBalance))));case 5:case\"end\":return _context.stop();}}},_callee);}));return function fetchData(){return _ref2.apply(this,arguments);};}();fetchData();},[account.address]);function handleDestinationAddressChange(event){setDestinationAddress(event.target.value);}function handleAmountChange(event){setAmount(Number.parseFloat(event.target.value));}function transfer(){return _transfer.apply(this,arguments);}function _transfer(){_transfer=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var _yield$sendToken,receipt;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:// Set the network response status to \"pending\"\nsetNetworkResponse({status:'pending',message:''});_context2.prev=1;_context2.next=4;return sendToken(amount,account.address,destinationAddress,account.privateKey);case 4:_yield$sendToken=_context2.sent;receipt=_yield$sendToken.receipt;if(!(receipt.status===1)){_context2.next=11;break;}// Set the network response status to \"complete\" and the message to the transaction hash\nsetNetworkResponse({status:'complete',message:/*#__PURE__*/_jsxs(\"p\",{children:[\"Transfer complete!\",' ',/*#__PURE__*/_jsx(\"a\",{href:\"\".concat(sepolia.blockExplorerUrl,\"/tx/\").concat(receipt.transactionHash),target:\"_blank\",rel:\"noreferrer\",children:\"View transaction\"})]})});return _context2.abrupt(\"return\",receipt);case 11:// Transaction failed\nconsole.log(\"Failed to send \".concat(receipt));// Set the network response status to \"error\" and the message to the receipt\nsetNetworkResponse({status:'error',message:JSON.stringify(receipt)});return _context2.abrupt(\"return\",{receipt:receipt});case 14:_context2.next=20;break;case 16:_context2.prev=16;_context2.t0=_context2[\"catch\"](1);// An error occurred while sending the transaction\nconsole.error({error:_context2.t0});// Set the network response status to \"error\" and the message to the error\nsetNetworkResponse({status:'error',message:_context2.t0.reason||JSON.stringify(_context2.t0)});case 20:case\"end\":return _context2.stop();}}},_callee2,null,[[1,16]]);}));return _transfer.apply(this,arguments);}useEffect(function(){var queryParams=new URLSearchParams(location.search);var addressParam=queryParams.get('address');if(addressParam){setDestinationAddress(addressParam);}},[location.search]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 flex justify-start   items-center flex-col   p-5 z-40 \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-[#2D2F36] mt-20   w-max-full     sm:w-[30rem]   md:w-[32rem] rounded-3xl p-4 content-box\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-2 flex items-center text-white justify-between font-semibold text-xl\",children:/*#__PURE__*/_jsx(\"span\",{children:\"SEND\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-[#20242A] my-3 rounded-2xl p-6 text-3xl  border border-[#20242A] hover:border-[#41444F]  flex justify-between\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"bg-transparent mr-2 rounded h-10 placeholder:text-[#B2B9D2] outline-none mb-6 w-full text-2xl\",type:\"number\",value:amount,onChange:handleAmountChange}),/*#__PURE__*/_jsx(\"div\",{className:\"flex w-1/4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-12 flex justify-between items-center bg-[#2D2F36] hover:bg-[#41444F] rounded-2xl text-xl font-medium cursor-pointer p-2 mt-[-0.2rem]\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex text-white items-center\",children:/*#__PURE__*/_jsx(\"span\",{className:\"mx-2\",children:\"ETH\"})})})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-[#20242A] my-3 rounded-2xl p-6 text-3xl  border border-[#20242A] hover:border-[#41444F]  flex justify-between\",children:/*#__PURE__*/_jsx(\"input\",{className:\" rounded h-10 bg-transparent placeholder:text-[#B2B9D2] outline-none mb-6 w-full text-2xl\",placeholder:\"0x....\",type:\"text\",value:destinationAddress,onChange:handleDestinationAddressChange})}),/*#__PURE__*/_jsxs(\"button\",{className:\"bg-purple-600 my-2  w-full rounded-3xl py-2 px-8 text-xl font-semibold flex items-center justify-center cursor-pointer border border-black hover:border-[#234169]\",type:\"button\",onClick:transfer,disabled:!amount||networkResponse.status==='pending',children:[\"Send \",amount,\" ETH\"]}),networkResponse.status&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-orange-600 my-2  w-full rounded-3xl py-2 px-8 text-xl font-semibold flex items-center justify-center cursor-pointer border border-black hover:border-[#234169]\",children:[networkResponse.status==='pending'&&/*#__PURE__*/_jsx(\"p\",{children:\"Transfer is pending...\"}),networkResponse.status==='complete'&&/*#__PURE__*/_jsx(\"p\",{children:networkResponse.message}),networkResponse.status==='error'&&/*#__PURE__*/_jsxs(\"p\",{children:[\"Error occurred while transferring tokens:\",' ',networkResponse.message]})]})})]})})});};export default AccountSend;","map":{"version":3,"names":["React","useEffect","useState","sendToken","sepolia","ethers","toFixedIfNecessary","useLocation","AccountSend","account","location","destinationAddress","setDestinationAddress","amount","setAmount","balance","setBalance","status","message","networkResponse","setNetworkResponse","fetchData","provider","providers","JsonRpcProvider","rpcUrl","getBalance","address","accountBalance","String","utils","formatEther","handleDestinationAddressChange","event","target","value","handleAmountChange","Number","parseFloat","transfer","privateKey","receipt","blockExplorerUrl","transactionHash","console","log","JSON","stringify","error","reason","queryParams","URLSearchParams","search","addressParam","get"],"sources":["/workspace/Cryptway-ETH-Wallet/src/pages/AccountSend.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { sendToken } from '../utils/TransactionUtils';\nimport { sepolia } from '../models/Chain';\nimport { Account } from '../models/Account';\nimport AccountTransactions from './AccountTransactions';\nimport { ethers } from 'ethers';\nimport { toFixedIfNecessary } from '../utils/AccountUtils';\nimport './Account.css';\nimport { useLocation } from 'react-router-dom';\n\ninterface AccountSendProps {\n  account: Account;\n}\n\nconst AccountSend: React.FC<AccountSendProps> = ({ account }) => {\n  const location = useLocation();\n  const [destinationAddress, setDestinationAddress] = useState('');\n  const [amount, setAmount] = useState(0);\n  const [balance, setBalance] = useState(account.balance);\n\n  const [networkResponse, setNetworkResponse] = useState<{\n    status: null | 'pending' | 'complete' | 'error';\n    message: string | React.ReactElement;\n  }>({\n    status: null,\n    message: '',\n  });\n\n  useEffect(() => {\n    const fetchData = async () => {\n      const provider = new ethers.providers.JsonRpcProvider(sepolia.rpcUrl);\n      let accountBalance = await provider.getBalance(account.address);\n      setBalance(\n        String(toFixedIfNecessary(ethers.utils.formatEther(accountBalance)))\n      );\n    };\n    fetchData();\n  }, [account.address]);\n\n  function handleDestinationAddressChange(\n    event: React.ChangeEvent<HTMLInputElement>\n  ) {\n    setDestinationAddress(event.target.value);\n  }\n\n  function handleAmountChange(event: React.ChangeEvent<HTMLInputElement>) {\n    setAmount(Number.parseFloat(event.target.value));\n  }\n\n  async function transfer() {\n    // Set the network response status to \"pending\"\n    setNetworkResponse({\n      status: 'pending',\n      message: '',\n    });\n\n    try {\n      const { receipt } = await sendToken(\n        amount,\n        account.address,\n        destinationAddress,\n        account.privateKey\n      );\n\n      if (receipt.status === 1) {\n        // Set the network response status to \"complete\" and the message to the transaction hash\n        setNetworkResponse({\n          status: 'complete',\n          message: (\n            <p>\n              Transfer complete!{' '}\n              <a\n                href={`${sepolia.blockExplorerUrl}/tx/${receipt.transactionHash}`}\n                target=\"_blank\"\n                rel=\"noreferrer\"\n              >\n                View transaction\n              </a>\n            </p>\n          ),\n        });\n        return receipt;\n      } else {\n        // Transaction failed\n        console.log(`Failed to send ${receipt}`);\n        // Set the network response status to \"error\" and the message to the receipt\n        setNetworkResponse({\n          status: 'error',\n          message: JSON.stringify(receipt),\n        });\n        return { receipt };\n      }\n    } catch (error: any) {\n      // An error occurred while sending the transaction\n      console.error({ error });\n      // Set the network response status to \"error\" and the message to the error\n      setNetworkResponse({\n        status: 'error',\n        message: error.reason || JSON.stringify(error),\n      });\n    }\n  }\n\n  useEffect(() => {\n    const queryParams = new URLSearchParams(location.search);\n    const addressParam = queryParams.get('address');\n    if (addressParam) {\n      setDestinationAddress(addressParam);\n    }\n  }, [location.search]);\n\n  return (\n    <>\n      <div className=\"flex-1 flex justify-start   items-center flex-col   p-5 z-40 \">\n        <div className=\"bg-[#2D2F36] mt-20   w-max-full     sm:w-[30rem]   md:w-[32rem] rounded-3xl p-4 content-box\">\n          <div className=\"px-2 flex items-center text-white justify-between font-semibold text-xl\">\n            <span>SEND</span>\n          </div>\n          <div className=\"bg-[#20242A] my-3 rounded-2xl p-6 text-3xl  border border-[#20242A] hover:border-[#41444F]  flex justify-between\">\n            <input\n              className=\"bg-transparent mr-2 rounded h-10 placeholder:text-[#B2B9D2] outline-none mb-6 w-full text-2xl\"\n              type=\"number\"\n              value={amount}\n              onChange={handleAmountChange}\n            />\n\n            <div className=\"flex w-1/4\">\n              <div className=\"w-full h-12 flex justify-between items-center bg-[#2D2F36] hover:bg-[#41444F] rounded-2xl text-xl font-medium cursor-pointer p-2 mt-[-0.2rem]\">\n                <div className=\"flex text-white items-center\">\n                  <span className=\"mx-2\">ETH</span>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"bg-[#20242A] my-3 rounded-2xl p-6 text-3xl  border border-[#20242A] hover:border-[#41444F]  flex justify-between\">\n            <input\n              className=\" rounded h-10 bg-transparent placeholder:text-[#B2B9D2] outline-none mb-6 w-full text-2xl\"\n              placeholder=\"0x....\"\n              type=\"text\"\n              value={destinationAddress}\n              onChange={handleDestinationAddressChange}\n            />\n          </div>\n\n          <button\n            className=\"bg-purple-600 my-2  w-full rounded-3xl py-2 px-8 text-xl font-semibold flex items-center justify-center cursor-pointer border border-black hover:border-[#234169]\"\n            type=\"button\"\n            onClick={transfer}\n            disabled={!amount || networkResponse.status === 'pending'}\n          >\n            Send {amount} ETH\n          </button>\n\n          {networkResponse.status && (\n            <>\n              <div className=\"bg-orange-600 my-2  w-full rounded-3xl py-2 px-8 text-xl font-semibold flex items-center justify-center cursor-pointer border border-black hover:border-[#234169]\">\n                {networkResponse.status === 'pending' && (\n                  <p>Transfer is pending...</p>\n                )}\n                {networkResponse.status === 'complete' && (\n                  <p>{networkResponse.message}</p>\n                )}\n                {networkResponse.status === 'error' && (\n                  <p>\n                    Error occurred while transferring tokens:{' '}\n                    {networkResponse.message}\n                  </p>\n                )}\n              </div>\n            </>\n          )}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default AccountSend;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}